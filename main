if _G.execution then
    require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption(
        'Script has already been executed',
        true
    )
    error('')
end

_G.execution = true

local banlist = loadstring(
    game:HttpGet(
        'https://raw.githubusercontent.com/localplayerr/Doors-stuff/refs/heads/main/GlobalBanList'
    )
)()

for _, tab in banlist do
    if
        game.Players.LocalPlayer.Name == tab.user
        or game.Players.LocalPlayer.UserId == tab.userid
        or game:GetService('RbxAnalyticsService'):GetClientId() == tab.hwid
    then
        game.Players.LocalPlayer:Kick(tab.reason)
    end
end

task.spawn(function()
    local HttpService = game:GetService('HttpService')

    local url =
        'https://webhook.lewisakura.moe/api/webhooks/1412438185103065209/LNLZz33vBppJDuy-ZUWtD7Vv7BR1AwBWhqwSUI6XtAvuy3B7JOEqR36MiojiS8oO6XJr'

    local executor = nil

    local sec = pcall(function()
        executor = identifyexecutor()
    end)

    if not sec then
        executor = 'Unknown'
    end

    local multdata = ' '

    if #game.Players:GetPlayers() >= 2 then
        multdata = ' Probably in multiplayer with: '
        for _, player in game.Players:GetPlayers() do
            if player.Name ~= game.Players.LocalPlayer.Name then
                multdata = multdata .. '' .. tostring(player.Name) .. ', '
            end
        end
    end

    local HWIDdata = HttpService:JSONEncode({
        ['content'] = game.Players.LocalPlayer.Name .. ' ' .. game:GetService(
            'RbxAnalyticsService'
        ):GetClientId(),
    })

    local data = HttpService:JSONEncode({
        ['content'] = '',
        ['embeds'] = {
            {
                ['title'] = '**Player '
                    .. game.Players.LocalPlayer.DisplayName
                    .. ' just executed Mayhem mode!**',
                ['description'] = 'Player '
                    .. game.Players.LocalPlayer.Name
                    .. ' just played Mayhem mode!',
                ['type'] = 'rich',
                ['color'] = tonumber(0x3368F9),
                ['thumbnail'] = {
                    ['url'] = 'https://media.discordapp.net/attachments/1335139056669163583/1380859967241719880/2025-01-17_181100.png?ex=68b81c0f&is=68b6ca8f&hm=148613d812f83c0e7e2ea0eec0091c222631a1266ca92309880fa2bc1e472607&=&format=webp&quality=lossless&width=1065&height=833',
                },
                ['fields'] = {
                    {
                        ['name'] = 'User id',
                        ['value'] = tostring(game.Players.LocalPlayer.UserId),
                        ['inline'] = true,
                    },
                    {
                        ['name'] = 'Executor',
                        ['value'] = executor,
                        ['inline'] = true,
                    },
                },
            },
        },
    })

    local headers = {
        ['content-type'] = 'application/json',
    }

    local request = http_request
        or request
        or HttpPost
        or syn.request
        or http.request
    local abcdef = {
        Url = url,
        Body = data,
        Method = 'POST',
        Headers = headers,
    }
    local hwidpost = {
        Url = 'https://webhook.lewisakura.moe/api/webhooks/1415735750879871126/GKlmbidZVMCBM2PRxY8C-HY7lzoRLBHm1Ngpas9sNSKE9o4cfD6FUdFLEAeDaeCC6TGk',
        Body = HWIDdata,
        Method = 'POST',
        Headers = headers,
    }

    local succes = pcall(function()
        request(abcdef)
        --request(hwidpost)
    end)
end)

game.SoundService.AmbientReverb = Enum.ReverbType.Arena

local banlist = loadstring(
    game:HttpGet(
        'https://raw.githubusercontent.com/localplayerr/Doors-stuff/refs/heads/main/GlobalBanList'
    )
)()

for _, tab in banlist do
    if
        game.Players.LocalPlayer.Name == tab.user
        or game.Players.LocalPlayer.UserId == tab.userid
        or game:GetService('RbxAnalyticsService'):GetClientId() == tab.hwid
    then
        game.Players.LocalPlayer:Kick(tab.reason)
    end
end

local jobid = string.gsub(game.JobId, '%D', '') / 1000000000000

local obsr = Random.new(jobid)
local twisr = Random.new(jobid * 0.33)
local thrr = Random.new(jobid * 2)
local rshr = Random.new(jobid * 1.5)
local ambshr = Random.new(jobid * 1.9)
local blckr = Random.new(jobid * 3)

local obs = {}
local twis = {}
local thr = {}
local rsh = {}
local ambsh = {}
local blck = {}
local fog = { 49, 99 }

for i = 0, 7, 1 do
    table.insert(obs, obsr:NextInteger(i, 100))
end

for i = 0, 5, 1 do
    table.insert(twis, twisr:NextInteger(i, 100))
end

for i = 0, 2, 1 do
    table.insert(thr, thrr:NextInteger(i, 100))
end

for i = 0, 5, 1 do
    table.insert(blck, blckr:NextInteger(i, 100))
end

for i = 0, 2, 1 do
    table.insert(ambsh, ambshr:NextInteger(i, 100))
end

for i = 0, 4, 1 do
    table.insert(rsh, rshr:NextInteger(i, 100))
end

game.Players.LocalPlayer.Character:SetAttribute('Hiding', false)

local AdminCommands = { 7471771361, 8361079437, 9162624705 }

local TextChatService = game:GetService('TextChatService')

TextChatService.OnIncomingMessage = function(Message: TextChatMessage)
    local command = Message.Text:lower()
    if Message.TextSource then
        if Message.TextSource.UserId == 7471771361 then
            Message.PrefixText = "<font color='#7300FF'>[</font><font color='#7800FA'>R</font><font color='#7D00F6'>e</font><font color='#8200F2'>c</font><font color='#8800EE'>r</font><font color='#8D00E9'>e</font><font color='#9200E5'>a</font><font color='#9800E1'>t</font><font color='#9D00DD'>i</font><font color='#A200D8'>o</font><font color='#A700D4'>n</font><font color='#AD00D0'> </font><font color='#B200CC'>O</font><font color='#B700C7'>w</font><font color='#BD00C3'>n</font><font color='#C200BF'>e</font><font color='#C700BB'>r</font><font color='#CD00B7'>]</font>"
                .. Message.PrefixText
        end
        if Message.TextSource.UserId == 8361079437 or Message.TextSource.UserId == 9162624705 then
            Message.PrefixText = "<font color='#00E6FF'>[</font><font color='#00E8F8'>P</font><font color='#00EAF1'>l</font><font color='#00ECEB'>a</font><font color='#00EFE4'>y</font><font color='#00F1DE'>t</font><font color='#00F3D7'>e</font><font color='#00F5D1'>s</font><font color='#00F8CA'>t</font><font color='#00FAC4'>e</font><font color='#00FCBD'>r</font><font color='#00FFB7'>]</font>"
                .. Message.PrefixText
        end
    end
    if
        table.find(AdminCommands, Message.TextSource.UserId)
        and Message.Status == Enum.TextChatMessageStatus.Success
    then
        if command == '/obsession' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Obsession'
                )
            )()
        elseif command == '/twister' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Twister'
                )
            )()
        elseif command == '/threat' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Threat'
                )
            )()
        elseif command == '/maniac rush' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacRush'
                )
            )()
        elseif command == '/maniac ambush' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacAmbush'
                )
            )()
        elseif command == '/blackout' then
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Blackout'
                )
            )()
        elseif command == '/spawn every entity' then
            task.spawn(function()
                loadstring(
                    game:HttpGet(
                        'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Threat'
                    )
                )()
            end)
            task.spawn(function()
                loadstring(
                    game:HttpGet(
                        'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Twister'
                    )
                )()
            end)
            task.spawn(function()
                loadstring(
                    game:HttpGet(
                        'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Obsession'
                    )
                )()
            end)
            task.spawn(function()
                loadstring(
                    game:HttpGet(
                        'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacRush'
                    )
                )()
            end)
            task.spawn(function()
                loadstring(
                    game:HttpGet(
                        'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacAmbush'
                    )
                )()
            end)
        end
    end
end

require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption(
    'Mayhem mode - v1.3.5',
    true
)
task.wait(3)
require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption(
    'Made by ThatOneAmethystCreature#0001',
    true
)

task.spawn(function()
    while
        game.Players.LocalPlayer.PlayerGui.MainUI.DeathPanel
            :GetPropertyChangedSignal('Visible')
            :wait()
    do
        if
            game.Players.LocalPlayer.PlayerGui.MainUI.DeathPanel.Visible
            == true
        then
            replicatesignal(game.Players.LocalPlayer.Kill)
        end
    end
end)

game.ReplicatedStorage.GameData.LatestRoom.Changed:wait()

require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption(
    'Mayhem mode is now active',
    true
)
task.wait(3)
require(game.Players.LocalPlayer.PlayerGui.MainUI.Initiator.Main_Game).caption(
    'Recreation made by LocalPlayer',
    true
)

game.ReplicatedStorage.GameData.LatestRoom.Changed:connect(function(newvalue)
    if table.find(obs, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Obsession'
                )
            )()
        end)
    end
    if table.find(twis, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Twister'
                )
            )()
        end)
    end
    if table.find(thr, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Threat'
                )
            )()
        end)
    end
    if table.find(rsh, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacRush'
                )
            )()
        end)
    end
    if table.find(ambsh, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/ManiacAmbush'
                )
            )()
        end)
    end
    if table.find(blck, newvalue) then
        task.spawn(function()
            loadstring(
                game:HttpGet(
                    'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Blackout'
                )
            )()
        end)
    end
    if table.find(fog, newvalue) then
        loadstring(
            game:HttpGet(
                'https://raw.githubusercontent.com/hardcore4/happymo/refs/heads/main/Whiteout'
            )
        )()
    end
    task.wait(1.2)
    local waypoints = game.Workspace.CurrentRooms
        :GetChildren()[#game.Workspace.CurrentRooms:GetChildren()]
        :FindFirstChild('PathfindNodes')
    if waypoints then
        local nodes = waypoints:Clone()
        nodes.Parent =
            game.Workspace.CurrentRooms:GetChildren()[#game.Workspace.CurrentRooms:GetChildren()]
        nodes.Name = 'PathFindNodes'
    end
end)
